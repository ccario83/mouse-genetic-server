
<% flash.each do |alert_type, notice| %>
flash_notice("<%= notice %>", "<%= alert_type %>");
<% end %>

$("#new-task").html("<%= escape_javascript(render :partial => 'shared/task_form', :locals => { user: @user, task: @task, members: @members }) %>");

// Reattach the :remote=>true form submit functionality
attach_submit('#new-task');
<% if not @task.valid? %>
<% @task.errors.messages.each do |field, errors| %>
	<% if errors.any? %>
	
		<% if field == :assignee %>
		field = $('#new-task #task_assignee_id');
		<% elsif field == :due_date %>
		field = $('#new-task #duedate');
		<% elsif field == :description  %>
		<% next %>
		<% end %>
	
		field.parent().parent().addClass('error');
		field.after("<p class='help-block'><%= errors[0] %></p>")
	<% end %>
<% end %>

$('#duedate').datetimepicker(
{
	language: 'en',
	format: 'yyyy-MM-dd hh:mm',
	pick12HourFormat: false,
	pickSeconds: false
});
// Reattach the :remote=>true form submit functionality
attach_submit('#new-task');
<% else %>
$("#new-task").modal('hide');
update_div('#task-panel');
<% end %>